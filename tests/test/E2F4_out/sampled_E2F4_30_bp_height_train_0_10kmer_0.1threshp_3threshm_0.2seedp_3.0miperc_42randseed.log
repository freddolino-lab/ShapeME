2020-06-17 14:05:55,241 Reading in files
2020-06-17 14:05:55,543 Distribution of sequences per class:
2020-06-17 14:05:55,560 
Cat 0: 827
Cat 1: 273
2020-06-17 14:05:55,604 Normalizing parameters
2020-06-17 14:05:55,732 MGW: (5.02, 0.5485619999999988)
2020-06-17 14:05:55,732 ProT: (-7.0, 4.67019)
2020-06-17 14:05:55,732 HelT: (34.6, 1.6012079999999973)
2020-06-17 14:05:55,732 Roll: (-2.0, 1.6753379999999998)
2020-06-17 14:05:55,732 Precomputing all windows
2020-06-17 14:05:57,290 Determining initial threshold
2020-06-17 14:05:57,308 Using 109 random seeds to determine threshold from pairwise distances
2020-06-17 14:05:57,539 Threshold mean: 53.15305173223984 and stdev 11.269784797626512
2020-06-17 14:05:57,539 Using 19.343697 as an initial match threshold
2020-06-17 14:05:57,540 Testing all seeds by brute force
2020-06-17 14:05:57,545 51700 possible seeds
2020-06-17 14:05:57,545 Finding MI for seeds
2020-06-17 14:05:57,548 Distribution of sequences per class for seed screening
2020-06-17 14:05:57,549 
Cat 0: 165
Cat 1: 54
2020-06-17 14:05:57,549 Distribution of sequences per class for regression
2020-06-17 14:05:57,549 
Cat 0: 662
Cat 1: 219
2020-06-17 14:05:57,549 Evaluating 51700 seeds over 4 processor(s)
2020-06-17 14:57:42,237 Printing top 5 seeds.
2020-06-17 14:57:42,239 Seed MI: 0.19483154599981078
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c4543160>
[-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:42,241 Seed MI: 0.17576521509692483
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c4445908>
[-0.12760636  0.30990116  0.61980232  0.12760636  0.71094972  0.94793296
  0.89324452  0.51042544 -0.12760636 -0.30990116  0.9143097   0.80082395
  0.73230425  0.82009511  0.77298782  0.59526486  0.58884114  0.91002722
  0.95071078  0.51389772 -0.78690589 -1.26779282 -0.68698133  1.02422671
 -1.38645323  0.63701905 -1.41767965 -0.6994719  -0.49962278  0.66200019
  0.20891307  2.38757791  0.3999193   0.25069568  2.97850344  0.53720503
  2.69199409  0.10147206  0.62077026  0.16116151]
2020-06-17 14:57:42,242 Seed MI: 0.17576521509692483
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55bf7d8390>
[-0.43750752 -0.7291792  -0.49219596 -0.3645896  -0.10937688  0.71094972
  0.94793296  0.89324452  0.51042544 -0.12760636  1.49244463  1.21622461
  1.27832058  1.04278413  0.88004985  0.77298782  0.59526486  0.58884114
  0.91002722  0.9143097  -0.48088693 -0.73069832 -0.6994719  -0.51835864
  1.00549085 -1.38645323  0.63701905 -1.41767965 -0.73694361 -0.4933775
 -0.3461988  -0.19697518 -0.12534784  0.12534784  0.18503729  2.97850344
  0.53720503  2.69199409  0.1730994   0.19697518]
2020-06-17 14:57:42,243 Seed MI: 0.16994735755801077
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55be462cf8>
[ 0.89324452  0.94793296  0.94793296  0.94793296  0.94793296  0.89324452
  0.51042544 -0.12760636 -0.30990116 -0.52865492  0.58884114  0.59526486
  0.59526486  0.59526486  0.59526486  0.58884114  0.91002722  0.95071078
  0.51389772  0.05353101  0.63701905 -1.34898152  0.68698133 -1.34898152
  0.63701905 -1.41767965 -0.6994719  -0.49962278  0.66824547 -1.73618918
  0.53720503  3.05609972  0.50736031  3.05609972  0.53720503  2.69199409
  0.10147206  0.62077026  0.02387578 -0.38201247]
2020-06-17 14:57:42,244 Seed MI: 0.1647240145309034
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c70fe668>
[-0.5468844  -0.10937688  0.6380318   0.89324452  0.94793296  0.71094972
 -0.10937688 -0.3645896  -0.49219596 -0.7291792   1.02779544  0.91645094
  0.70018565  0.58884114  0.59526486  0.77298782  0.88004985  1.04278413
  1.27832058  1.21622461  1.34273623 -0.79315117 -1.36771737  0.63701905
 -1.38645323  1.00549085 -0.51835864 -0.6994719  -0.73069832 -0.37471709
 -0.10147206  0.41185719  2.82331088  0.53720503  2.97850344  0.18503729
  0.12534784 -0.12534784 -0.19697518 -0.62077026]
2020-06-17 14:57:42,313 Printing bottom 5 seeds.
2020-06-17 14:57:42,314 Seed MI: 0.0
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c66a3a90>
[-0.0911474  -0.71094972 -1.20314568 -1.80471852 -1.60419424 -1.60419424
 -0.01822948  0.83855608  1.822948    1.49481736  0.38542329 -0.66164332
 -1.05563157 -0.7665641   1.16483484  1.16483484 -0.41111818 -0.75799914
 -0.22697149  0.          1.03047199  0.83686816  1.08043427 -1.32400038
  2.15462326 -1.52384949  0.21233968  0.14988684 -1.95477415  0.2872831
  0.56704975 -0.70433548 -1.79665238 -0.95503116 -1.40270202 -0.53720503
 -0.69836654  5.44367763 -0.75208704  4.38120546]
2020-06-17 14:57:42,315 Seed MI: 0.0
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c66a3c18>
[-1.60419424 -1.60419424 -0.01822948  0.83855608  1.822948    1.49481736
  0.87501504  0.3645896  -0.92970348  0.92970348  1.16483484  1.16483484
 -0.41111818 -0.75799914 -0.22697149  0.          0.19913537 -0.82009511
 -0.64451339 -0.56742873  2.15462326 -1.52384949  0.21233968  0.14988684
 -1.95477415  0.2872831   0.38096237  0.87433987 -1.19909468  0.19984911
 -1.40270202 -0.53720503 -0.69836654  5.44367763 -0.75208704  4.38120546
  1.26541629 -0.46557769 -1.42060886  5.55708758]
2020-06-17 14:57:42,317 Seed MI: 0.0
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c66a90b8>
[-2.31514396  0.3645896   1.67711216  0.69272024 -0.455737   -0.80209712
 -0.7291792  -1.0937688  -0.67449076  0.30990116 -0.89503853 -0.82009511
  0.169158   -0.00856496  0.2376777   0.99139435  1.21622461  1.46889099
 -0.46250795 -0.79654147  0.94928329  0.19360383 -0.0811887  -0.31850953
 -0.16237741 -0.67449076 -0.37471709 -1.4801325   0.26230196  0.58081149
 -0.60883237  1.46239147  3.55152214 -0.65658393  0.33426091 -0.24472674
 -0.62077026 -0.68642865 -1.080379    4.75128004]
2020-06-17 14:57:42,318 Seed MI: 0.0
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c66a9be0>
[-1.367211   -0.51042544  0.56511388  1.49481736  1.22137516 -0.61980232
 -1.0937688   0.52865492  1.29429308  0.87501504 -1.08989142 -0.76014038
  0.70018565  0.00428248  0.10492078  1.16911732  0.07708466 -0.33617476
 -0.2483839  -0.49890904  0.81188703  1.18035883 -1.8923213  -0.2060944
 -1.96101943  0.32475481 -0.16237741  0.23107554 -0.61203791  0.31226424
 -0.5192982   0.84162121  0.41185719  4.23198184 -0.35216774  0.1730994
 -0.65658393  3.86787621 -0.00596894  3.34260907]
2020-06-17 14:57:42,319 Seed MI: 0.0
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c66a9da0>
[ 1.22137516 -0.61980232 -1.0937688   0.52865492  1.29429308  0.87501504
  0.85678556  0.74740868  1.1849162   0.8203266   0.10492078  1.16911732
  0.07708466 -0.33617476 -0.2483839  -0.49890904 -0.05353101 -0.27407878
  0.12205071  0.14560435 -1.96101943  0.32475481 -0.16237741  0.23107554
 -0.61203791  0.31226424 -0.29977367  0.40594351 -0.13739627 -1.97351
 -0.35216774  0.1730994  -0.65658393  3.86787621 -0.00596894  3.34260907
 -0.14922362  0.35216774  3.8798141   0.10147206]
2020-06-17 14:57:42,581 Filtering seeds by AIC individually
2020-06-17 14:57:42,900 Printing top 5 seeds.
2020-06-17 14:57:42,901 Seed MI: 0.19483154599981078
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c4543160>
[-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:42,902 Printing bottom 5 seeds.
2020-06-17 14:57:42,903 Seed MI: 0.19483154599981078
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c4543160>
[-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:42,903 1 seeds survived
2020-06-17 14:57:42,903 Finding minimum match scores for each motif
2020-06-17 14:57:42,903 Writing motifs before regression
2020-06-17 14:57:43,185 Running L1 regularized logistic regression with CV to determine reg param
2020-06-17 14:57:43,508 best score
 mean: 0.8630021141649049, sem: 0.00721492653836677
2020-06-17 14:57:43,508 Score within 2 se
 0.8485722610881714
2020-06-17 14:57:43,511 1 seeds survived
2020-06-17 14:57:43,512 best score
 mean: 0.8630021141649049, sem: 0.00721492653836677
2020-06-17 14:57:43,512 Score within 2 se
 0.8485722610881714
2020-06-17 14:57:51,268 Printing top 5 seeds.
2020-06-17 14:57:51,269 Seed MI: 0.19483154599981078
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c4543160>
[-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:51,270 Printing bottom 5 seeds.
2020-06-17 14:57:51,271 Seed MI: 0.19483154599981078
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c4543160>
[-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:51,271 Writing motifs after regression
2020-06-17 14:57:51,273 Seed: [-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:51,273 MI: 0.194832
2020-06-17 14:57:51,273 Motif Entropy: 0.425555
2020-06-17 14:57:51,273 Category Entropy: 0.805805
2020-06-17 14:57:51,273 Two way table for cat 0 is [0, 19, 165, 35]
/home/mbwolfe/src/tinker_motif_finder/DNAshape_motif_finder/find_motifs.py:189: RuntimeWarning: divide by zero encountered in log
  return np.log(num/denom)
2020-06-17 14:57:51,274 Enrichment for Cat 0 is -inf
2020-06-17 14:57:51,275 Two way table for cat 1 is [19, 0, 35, 165]
/home/mbwolfe/src/tinker_motif_finder/DNAshape_motif_finder/find_motifs.py:187: RuntimeWarning: divide by zero encountered in true_divide
  num = np.array(two_way[0], dtype=float)/np.array(two_way[1],dtype=float)
2020-06-17 14:57:51,275 Enrichment for Cat 1 is inf
2020-06-17 14:57:51,275 Generating initial heatmap for passing seeds
/home/mbwolfe/src/tinker_motif_finder/DNAshape_motif_finder/find_motifs.py:189: RuntimeWarning: divide by zero encountered in log
  return np.log(num/denom)
/home/mbwolfe/src/tinker_motif_finder/DNAshape_motif_finder/find_motifs.py:187: RuntimeWarning: divide by zero encountered in true_divide
  num = np.array(two_way[0], dtype=float)/np.array(two_way[1],dtype=float)
2020-06-17 14:57:51,276 Testing final optimized seeds on held out database
2020-06-17 14:57:51,276 Computing MI for motif 0
2020-06-17 14:57:52,381 Filtering seeds by Conditional MI using 3.000000 as a cutoff
2020-06-17 14:57:52,381 Printing top 5 seeds.
2020-06-17 14:57:52,383 Seed MI: 0.1366074250119731
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c4543160>
[-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:52,383 Printing bottom 5 seeds.
2020-06-17 14:57:52,384 Seed MI: 0.1366074250119731
 Seed Mem: <dnashapeparams.ShapeParams object at 0x7f55c4543160>
[-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:52,384 1 seeds survived
2020-06-17 14:57:52,385 Seed: [-0.34636012  0.6380318   0.89324452  0.94793296  0.71094972  0.12760636
  0.61980232  0.67449076 -0.01822948 -0.1822948   0.84793124  0.70018565
  0.58884114  0.59526486  0.77298782  0.82009511  0.73230425  0.81581263
  0.41325942  0.19271165 -0.77441532 -1.36771737  0.63701905 -1.38645323
  1.02422671 -0.68698133 -1.16786826 -0.65575491  0.74318889 -1.86109487
  0.37007458  2.82331088  0.53720503  2.97850344  0.25069568  0.3999193
  2.20850957  0.82968332  0.04178261  0.09550312]
2020-06-17 14:57:52,385 MI: 0.136607
2020-06-17 14:57:52,385 Calculating Z-score for motif 0
2020-06-17 14:57:53,173 Z-score: 118.204108
2020-06-17 14:57:53,173 Calculating Robustness for motif 0
2020-06-17 14:58:00,702 Robustness: 10/10
2020-06-17 14:58:00,703 Motif Entropy: 0.404256
2020-06-17 14:58:00,703 Category Entropy: 0.809022
2020-06-17 14:58:00,703 Two way table for cat 0 is [5, 66, 657, 153]
2020-06-17 14:58:00,703 Enrichment for Cat 0 is -4.0374629266845
2020-06-17 14:58:00,703 Two way table for cat 1 is [66, 5, 153, 657]
2020-06-17 14:58:00,703 Enrichment for Cat 1 is 4.0374629266845
2020-06-17 14:58:00,703 Generating final heatmap for seeds
2020-06-17 14:58:00,704 Writing final motifs
